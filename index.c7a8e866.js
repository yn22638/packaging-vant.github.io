import{e as o,n as a,t as r,m as s,g as e,A as i,S as l,i as n,H as t,T as d,j as c,U as u,V as v,b as g,W as h,X as f,Y as m,Z as p,I as w,h as S}from"./index.127bd108.js";const[y,z]=o("image");const x=S(e({name:y,props:{src:String,alt:String,fit:String,position:String,round:Boolean,width:a,height:a,radius:a,lazyLoad:Boolean,iconSize:a,showError:r,errorIcon:s("photo-fail"),iconPrefix:String,showLoading:r,loadingIcon:s("photo")},emits:["load","error"],setup(o,{emit:a,slots:r}){const s=i(!1),e=i(!0),S=i(),{$Lazyload:y}=l().proxy,x=n((()=>{const a={width:t(o.width),height:t(o.height)};return d(o.radius)&&(a.overflow="hidden",a.borderRadius=t(o.radius)),a}));c((()=>o.src),(()=>{s.value=!1,e.value=!0}));const I=o=>{e.value=!1,a("load",o)},L=o=>{s.value=!0,e.value=!1,a("error",o)},b=(a,r,s)=>s?s():g(w,{name:a,size:o.iconSize,class:r,classPrefix:o.iconPrefix},null),$=()=>{if(s.value||!o.src)return;const a={alt:o.alt,class:z("img"),style:{objectFit:o.fit,objectPosition:o.position}};return o.lazyLoad?h(g("img",m({ref:S},a),null),[[f("lazy"),o.src]]):g("img",m({src:o.src,onLoad:I,onError:L},a),null)},j=({el:o})=>{const a=()=>{o===S.value&&e.value&&I()};S.value?a():p(a)},P=({el:o})=>{o!==S.value||s.value||L()};return y&&u&&(y.$on("loaded",j),y.$on("error",P),v((()=>{y.$off("loaded",j),y.$off("error",P)}))),()=>{var a;return g("div",{class:z({round:o.round}),style:x.value},[$(),e.value&&o.showLoading?g("div",{class:z("loading")},[b(o.loadingIcon,z("loading-icon"),r.loading)]):s.value&&o.showError?g("div",{class:z("error")},[b(o.errorIcon,z("error-icon"),r.error)]):void 0,null==(a=r.default)?void 0:a.call(r)])}}}));export{x as I};
