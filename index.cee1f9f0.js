import{g as o,n as a,t as r,m as s,d as e,r as i,S as l,q as n,H as t,T as d,s as c,U as u,V as v,e as g,W as f,X as h,Y as m,Z as p,I as w,j as S}from"./index.3a3ccf96.js";const[y,z]=o("image");const x=S(e({name:y,props:{src:String,alt:String,fit:String,position:String,round:Boolean,width:a,height:a,radius:a,lazyLoad:Boolean,iconSize:a,showError:r,errorIcon:s("photo-fail"),iconPrefix:String,showLoading:r,loadingIcon:s("photo")},emits:["load","error"],setup(o,{emit:a,slots:r}){const s=i(!1),e=i(!0),S=i(),{$Lazyload:y}=l().proxy,x=n((()=>{const a={width:t(o.width),height:t(o.height)};return d(o.radius)&&(a.overflow="hidden",a.borderRadius=t(o.radius)),a}));c((()=>o.src),(()=>{s.value=!1,e.value=!0}));const I=o=>{e.value=!1,a("load",o)},L=o=>{s.value=!0,e.value=!1,a("error",o)},$=(a,r,s)=>s?s():g(w,{name:a,size:o.iconSize,class:r,classPrefix:o.iconPrefix},null),j=()=>{if(s.value||!o.src)return;const a={alt:o.alt,class:z("img"),style:{objectFit:o.fit,objectPosition:o.position}};return o.lazyLoad?f(g("img",m({ref:S},a),null),[[h("lazy"),o.src]]):g("img",m({src:o.src,onLoad:I,onError:L},a),null)},P=({el:o})=>{const a=()=>{o===S.value&&e.value&&I()};S.value?a():p(a)},b=({el:o})=>{o!==S.value||s.value||L()};return y&&u&&(y.$on("loaded",P),y.$on("error",b),v((()=>{y.$off("loaded",P),y.$off("error",b)}))),()=>{var a;return g("div",{class:z({round:o.round}),style:x.value},[j(),e.value&&o.showLoading?g("div",{class:z("loading")},[$(o.loadingIcon,z("loading-icon"),r.loading)]):s.value&&o.showError?g("div",{class:z("error")},[$(o.errorIcon,z("error-icon"),r.error)]):void 0,null==(a=r.default)?void 0:a.call(r)])}}}));export{x as I};
