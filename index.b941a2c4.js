import{e as o,g as e,ag as a,n as t,aa as s,G as i,i as l,j as n,b as c,aw as r,p as m,O as u,L as v,A as d,ak as h,C as p,aj as g,aN as f,Z as w,ah as y,Y as x,ao as b,aO as I,t as C,aP as P,s as Z,at as z,m as X,N as Y,ap as _,aQ as H,I as T,U as W,f as F,h as G,aR as R,aS as S,_ as k,aT as N,o as $,c as j,w as D,a as O,P as B,Q as U,aU as A,a1 as M,az as L,d as Q}from"./index.127bd108.js";import{I as q}from"./index.c7a8e866.js";import{B as E}from"./index.8eede4b4.js";const J=o=>Math.sqrt((o[0].clientX-o[1].clientX)**2+(o[0].clientY-o[1].clientY)**2),K=o("image-preview")[1];var V=e({props:{src:String,show:Boolean,active:Number,minZoom:a(t),maxZoom:a(t),rootWidth:a(Number),rootHeight:a(Number)},emits:["scale","close"],setup(o,{emit:e}){const a=s({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),t=i(),d=l((()=>{const{rootWidth:e,rootHeight:t}=o,s=t/e;return a.imageRatio>s})),h=l((()=>{const{scale:o,moveX:e,moveY:t,moving:s,zooming:i}=a,l={transitionDuration:i||s?"0s":".3s"};if(1!==o){const a=e/o,s=t/o;l.transform=`scale(${o}, ${o}) translate(${a}px, ${s}px)`}return l})),p=l((()=>{if(a.imageRatio){const{rootWidth:e,rootHeight:t}=o,s=d.value?t/a.imageRatio:e;return Math.max(0,(a.scale*s-e)/2)}return 0})),g=l((()=>{if(a.imageRatio){const{rootWidth:e,rootHeight:t}=o,s=d.value?t:e*a.imageRatio;return Math.max(0,(a.scale*s-t)/2)}return 0})),f=t=>{(t=u(t,+o.minZoom,+o.maxZoom+1))!==a.scale&&(a.scale=t,e("scale",{scale:t,index:o.active}))},w=()=>{f(1),a.moveX=0,a.moveY=0};let y,x,b,I,C,P,Z;const z=o=>{const{touches:e}=o,{offsetX:s}=t;t.start(o),y=e.length,x=a.moveX,b=a.moveY,Z=Date.now(),a.moving=1===y&&1!==a.scale,a.zooming=2===y&&!s.value,a.zooming&&(I=a.scale,C=J(o.touches))},X=o=>{const{touches:e}=o;if(t.move(o),(a.moving||a.zooming)&&m(o,!0),a.moving){const{deltaX:o,deltaY:e}=t,s=o.value+x,i=e.value+b;a.moveX=u(s,-p.value,p.value),a.moveY=u(i,-g.value,g.value)}if(a.zooming&&2===e.length){const o=J(e);f(I*o/C)}},Y=()=>{if(y>1)return;const{offsetX:o,offsetY:s}=t,i=Date.now()-Z;o.value<5&&s.value<5&&i<250&&(P?(clearTimeout(P),P=null,(()=>{const o=a.scale>1?1:2;f(o),a.moveX=0,a.moveY=0})()):P=setTimeout((()=>{e("close"),P=null}),250))},_=e=>{let s=!1;(a.moving||a.zooming)&&(s=!0,a.moving&&x===a.moveX&&b===a.moveY&&(s=!1),e.touches.length||(a.zooming&&(a.moveX=u(a.moveX,-p.value,p.value),a.moveY=u(a.moveY,-g.value,g.value),a.zooming=!1),a.moving=!1,x=0,b=0,I=1,a.scale<1&&w(),a.scale>o.maxZoom&&(a.scale=+o.maxZoom))),m(e,s),Y(),t.reset()},H=o=>{const{naturalWidth:e,naturalHeight:t}=o.target;a.imageRatio=t/e};return n((()=>o.active),w),n((()=>o.show),(o=>{o||w()})),()=>{const e={loading:()=>c(v,{type:"spinner"},null)};return c(r,{class:K("swipe-item"),onTouchstart:z,onTouchmove:X,onTouchend:_,onTouchcancel:_},{default:()=>[c(q,{src:o.src,fit:"contain",class:K("image",{vertical:d.value}),style:h.value,onLoad:H},e)]})}}});const[oo,eo]=o("image-preview"),ao=["show","transition","overlayStyle","closeOnPopstate"];var to=e({name:oo,props:{show:Boolean,loop:C,images:P(),minZoom:Z(1/3),maxZoom:Z(3),overlay:C,closeable:Boolean,showIndex:C,className:z,closeIcon:X("clear"),transition:String,beforeClose:Function,overlayClass:z,overlayStyle:Object,swipeDuration:Z(300),startPosition:Z(0),showIndicators:Boolean,closeOnPopstate:C,closeIconPosition:X("top-right")},emits:["scale","close","closed","change","update:show"],setup(o,{emit:e,slots:a}){const t=d(),i=s({active:0,rootWidth:0,rootHeight:0}),l=()=>{if(t.value){const o=Y(t.value.$el);i.rootWidth=o.width,i.rootHeight=o.height,t.value.resize()}},r=o=>e("scale",o),m=o=>e("update:show",o),u=()=>{_(o.beforeClose,{args:[i.active],done:()=>m(!1)})},v=o=>{o!==i.active&&(i.active=o,e("change",o))},C=()=>{if(o.showIndex)return c("div",{class:eo("index")},[a.index?a.index({index:i.active}):`${i.active+1} / ${o.images.length}`])},P=()=>{if(a.cover)return c("div",{class:eo("cover")},[a.cover()])},Z=()=>{if(o.closeable)return c(T,{role:"button",name:o.closeIcon,class:[eo("close-icon",o.closeIconPosition),H],onClick:u},null)},z=()=>e("closed"),X=(o,e)=>{var a;return null==(a=t.value)?void 0:a.swipeTo(o,e)};return h({swipeTo:X}),p(l),n([g,f],l),n((()=>o.startPosition),(o=>v(+o))),n((()=>o.show),(a=>{const{images:t,startPosition:s}=o;a?(v(+s),w((()=>{l(),X(+s,{immediate:!0})}))):e("close",{index:i.active,url:t[i.active]})})),()=>c(I,x({class:[eo(),o.className],overlayClass:[eo("overlay"),o.overlayClass],onClosed:z,"onUpdate:show":m},b(o,ao)),{default:()=>[Z(),c(y,{ref:t,lazyRender:!0,loop:o.loop,class:eo("swipe"),duration:o.swipeDuration,initialSwipe:o.startPosition,showIndicators:o.showIndicators,indicatorColor:"white",onChange:v},{default:()=>[o.images.map((e=>c(V,{src:e,show:o.show,active:i.active,maxZoom:o.maxZoom,minZoom:o.minZoom,rootWidth:i.rootWidth,rootHeight:i.rootHeight,onScale:r,onClose:u},null)))]}),C(),P()]})}});let so;const io={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};const lo=(o,e=0)=>{if(W)return so||({instance:so}=R({setup(){const{state:o,toggle:e}=S(),a=()=>{o.images=[]};return()=>c(to,x(o,{onClosed:a,"onUpdate:show":e}),null)}})),o=Array.isArray(o)?{images:o,startPosition:e}:o,so.open(F({},io,o)),so};lo.Component=G(to),lo.install=o=>{o.use(lo.Component)};const no={class:""},co=Q("明月直入，无心可猜。"),ro=Q("仙人抚我顶，结发受长生。"),mo=Q("今人不见古时月，今月曾经照古人。"),uo=["src"],vo={class:"btns"},ho=Q("点击展开preview"),po=Q("点击生成图片"),go={key:0,class:"edit-preview"},fo={key:1,style:{marginTop:"16px"}},wo=Q("加载失败");var yo=k(e({setup(o){d(!1);const e=d(!1),a=d(!1);d(0);const t=d([{url:"https://t7.baidu.com/it/u=4254889666,2174977374&fm=193&f=GIF"},{url:"https://t7.baidu.com/it/u=1500571650,3211010172&fm=193&f=GIF"},{url:"https://t7.baidu.com/it/u=727460147,2222092211&fm=193&f=GIF"},{url:"https://t7.baidu.com/it/u=2763645735,2016465681&fm=193&f=GIF"},{url:"https://t7.baidu.com/it/u=48006913,1459517342&fm=193&f=GIF"}]),s=d([{title:"分享",icon:"share-o"},{title:"添加",icon:"plus"},{title:"下载",icon:"down"},{title:"删除",icon:"delete-o"}]),i=()=>{e.value=!0,lo({images:["https://t7.baidu.com/it/u=48006913,1459517342&fm=193&f=GIF","https://t7.baidu.com/it/u=727460147,2222092211&fm=193&f=GIF","https://t7.baidu.com/it/u=1500571650,3211010172&fm=193&f=GIF"],startPosition:0,closeable:!0,onClose:()=>e.value=!1})};return(o,l)=>{const n=r,m=y,u=N,d=E,h=T,p=v,g=q;return $(),j("div",no,[c(u,{"left-icon":"volume-o",scrollable:!1},{default:D((()=>[c(m,{vertical:"",class:"notice-swipe",autoplay:3e3,"show-indicators":!1},{default:D((()=>[c(n,null,{default:D((()=>[co])),_:1}),c(n,null,{default:D((()=>[ro])),_:1}),c(n,null,{default:D((()=>[mo])),_:1})])),_:1})])),_:1}),c(m,{class:"my-swipe",autoplay:3e3,"indicator-color":"white","lazy-render":""},{default:D((()=>[($(!0),j(B,null,U(t.value,((o,e)=>($(),M(n,{key:e},{default:D((()=>[O("img",{src:o.url,alt:""},null,8,uo)])),_:2},1024)))),128))])),_:1}),O("div",vo,[c(d,{class:"open-btn",type:"success",onClick:i},{default:D((()=>[ho])),_:1}),c(d,{class:"",type:"success",onClick:l[0]||(l[0]=o=>a.value=!a.value)},{default:D((()=>[po])),_:1})]),e.value?($(),j("div",go,[($(!0),j(B,null,U(s.value,((o,e)=>($(),j("div",{key:e,class:"preview-item"},[O("p",null,L(o.title),1),c(h,{name:o.icon},null,8,["name"])])))),128))])):A("",!0),a.value?($(),j("div",fo,[($(),j(B,null,U(8,((o,e)=>c(g,{round:"",width:"100px",height:"100px",src:`https://picsum.photos/10${e}`,style:{padding:"6px 10px"}},{loading:D((()=>[c(p,{type:"spinner",size:"20"})])),error:D((()=>[wo])),_:2},1032,["src"]))),64))])):A("",!0)])}}}),[["__scopeId","data-v-7b49ee66"]]);export{yo as default};
